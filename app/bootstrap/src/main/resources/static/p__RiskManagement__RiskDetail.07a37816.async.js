(self.webpackChunk=self.webpackChunk||[]).push([[3635],{82826:function(y,f,e){"use strict";e.d(f,{Z:function(){return d}});var a=e(87462),s=e(62435),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},i=o,_=e(84089),g=function(c,j){return s.createElement(_.Z,(0,a.Z)({},c,{ref:j,icon:i}))},x=s.forwardRef(g),d=x},52078:function(y,f,e){"use strict";var a=e(97857),s=e.n(a),o=e(27997),i=e(62435),_=e(86074),g=function(d){o.Mj.register({id:"json"});var m=d.value,c=d.onChange,j=d.editorStyle,C=j===void 0?{}:j,S=d.editorKey,l=d.readOnly,u=l===void 0?!1:l,v=(0,i.useRef)(),r=(0,i.useRef)();return(0,i.useEffect)(function(){if(v.current)return r.current?r.current.setValue(m):(r.current=o.j6.create(v.current,{value:m,language:"json",theme:"vs",readOnly:u,folding:!0,automaticLayout:!0}),r.current.onDidChangeModelContent(function(){c==null||c(r.current.getValue())})),function(){if(r!=null&&r.current){var D;r==null||(D=r.current)===null||D===void 0||D.dispose(),r.current=null}}},[]),(0,i.useEffect)(function(){r.current&&m!==r.current.getValue()&&r.current.setValue(m)},[m]),(0,_.jsx)("div",{ref:v,style:s()({height:360,borderRadius:4,overflow:"hidden"},C)},S)};f.Z=g},29297:function(y,f,e){"use strict";e.d(f,{q9:function(){return a.Z},Wy:function(){return d},mi:function(){return C}});var a=e(52078),s=e(97857),o=e.n(s),i=e(55171),_=e.n(i),g=e(86074),x=function(l){var u=l.value,v=l.viewerStyle,r=v===void 0?{}:v,D=l.displayDataTypes,E=D===void 0?!1:D,R=l.name,I=R===void 0?"output json":R;return(0,g.jsx)(_(),{src:u,name:I,collapsed:!1,displayDataTypes:E,style:o()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},r)})},d=x,m=e(27997),c=e(62435),j=function(l){m.Mj.register({id:"rego"});var u=l.value,v=l.onChange,r=l.editorStyle,D=r===void 0?{}:r,E=l.editorKey,R=l.readOnly,I=R===void 0?!1:R,T=(0,c.useRef)(),O=(0,c.useRef)();return(0,c.useEffect)(function(){if(T.current)return O.current||(O.current=m.j6.create(T.current,{value:u,language:"rego",theme:"vs",readOnly:I,automaticLayout:!0}),O.current.onDidChangeModelContent(function(){v==null||v(O.current.getValue())})),function(){if(O.current){var h;(h=O.current)===null||h===void 0||h.dispose(),O.current=null}}},[]),(0,g.jsx)("div",{ref:T,style:o()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},D)},E)},C=j},35469:function(y,f,e){"use strict";e.r(f);var a=e(5574),s=e.n(a),o=e(87426),i=e(39421),_=e(24163),g=e(71448),x=e(96364),d=e(47908),m=e(72028),c=e(29448),j=e(82826),C=e(45742),S=e(39380),l=e(93410),u=e(92016),v=e(25593),r=e(83622),D=e(4393),E=e(86250),R=e(42075),I=e(66309),T=e(83062),O=e(21532),h=e(23323),L=e(62435),$=e(24482),w=e(50322),H=e(22145),t=e(86074),P=v.Z.Text,J=function(){var p,A,B,W,U,K,z=(0,u.useLocation)(),G=new URLSearchParams(z.search),Q=(0,L.useState)(G.get("id")),X=s()(Q,1),Z=X[0],Y=(0,u.useModel)("rule"),q=Y.platformList,ee=(0,u.useModel)("tenant"),V=ee.tenantListAll,ne=(0,L.useState)(!1),k=s()(ne,2),te=k[0],re=k[1],se=(0,L.useState)(!1),F=s()(se,2),oe=F[0],N=F[1],b=(0,u.useRequest)(function(M){return(0,m.queryRiskDetailById)({riskId:M})},{manual:!0,formatResult:function(le){return le.content||{}}}),n=b.data,ie=b.run,ae=b.loading;return(0,L.useEffect)(function(){Z&&ie(Z)},[Z]),(0,t.jsx)(S._z,{loading:ae,breadcrumbRender:!1,title:(0,t.jsxs)(r.ZP,{type:"link",size:"small",onClick:function(){return u.history===null||u.history===void 0?void 0:u.history.back()},children:[(0,t.jsx)(j.Z,{})," \u8FD4\u56DE"]}),className:d.Z.riskDetailContainer,children:(0,t.jsxs)(D.Z,{className:d.Z.riskDetailAroundCard,children:[(0,t.jsxs)(l.Z,{style:{marginBottom:18},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,t.jsx)(E.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,t.jsxs)("span",{children:[(0,t.jsx)(P,{style:{marginRight:12},children:(0,t.jsx)(r.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(n==null?void 0:n.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(n==null||(p=n.ruleVO)===null||p===void 0?void 0:p.ruleName)||"-"})}),(0,t.jsxs)(R.Z,{children:[(0,t.jsx)("span",{children:(0,c.Ff)(x.MW,n==null?void 0:n.status)}),(n==null?void 0:n.ignoreReasonType)&&(0,t.jsxs)("span",{children:[(0,t.jsx)(P,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u7C7B\u578B:"}),(0,t.jsx)(I.Z,{color:"geekblue",children:((A=x.$G.find(function(M){return M.value===(n==null?void 0:n.ignoreReasonType)}))===null||A===void 0?void 0:A.label)||"-"})]}),(n==null?void 0:n.ignoreReason)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:"\u5FFD\u7565\u539F\u56E0:"}),(0,t.jsx)(_.Z,{rows:1,text:n==null?void 0:n.ignoreReason,maxWidth:64})]})]})]})}),(0,t.jsxs)(E.Z,{vertical:!0,gap:10,children:[(0,t.jsxs)(E.Z,{align:"center",children:[(0,t.jsx)("img",{src:i.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u6700\u8FD1\u626B\u63CF\u547D\u4E2D:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtModified})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("img",{src:o.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,t.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:"\u9996\u6B21\u53D1\u73B0\u65F6\u95F4:"}),(0,t.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:n==null?void 0:n.gmtCreate})]})]}),(0,t.jsxs)(E.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,t.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,c.fD)(n==null?void 0:n.platform,q)}),(0,t.jsx)(P,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceType)||"-"}),(0,t.jsxs)(E.Z,{align:"center",children:[(0,t.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(n==null?void 0:n.resourceName)+" / "+(n==null?void 0:n.resourceId)}),(0,t.jsx)(T.Z,{title:"\u8D44\u4EA7\u8BE6\u60C5",children:(0,t.jsx)("span",{className:d.Z.iconWrap,onClick:function(){return N(!0)},children:(0,t.jsx)(C.Z,{className:d.Z.resourceInstance})})})]}),(0,t.jsx)(P,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(V==null||(B=V.find(function(M){return M.value===(n==null?void 0:n.tenantId)}))===null||B===void 0?void 0:B.label)||"-"})]})]}),(0,t.jsx)(O.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,t.jsxs)(h.Z,{children:[(0,t.jsx)(h.Z.Item,{label:"\u4FEE\u590D\u5EFA\u8BAE",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(W=n.ruleVO)===null||W===void 0?void 0:W.advice)||"-"})}),(0,t.jsx)(h.Z.Item,{label:"\u53C2\u8003\u94FE\u63A5",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(U=n.ruleVO)===null||U===void 0?void 0:U.link)||"-"})}),(0,t.jsx)(h.Z.Item,{label:"\u89C4\u5219\u63CF\u8FF0",children:(0,t.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(n==null||(K=n.ruleVO)===null||K===void 0?void 0:K.ruleDesc)||"-"})})]})}),(0,t.jsx)(g.Z,{riskDrawerInfo:n}),(0,t.jsx)(w.Z,{riskDrawerInfo:n}),(0,t.jsx)($.Z,{evaluateDrawerVisible:te,setEvaluateDrawerVisible:re,riskDrawerInfo:n}),(0,t.jsx)(H.Z,{resourceDrawerVisible:oe,setResourceDrawerVisible:N,riskDrawerInfo:n})]})})};f.default=J},85674:function(y,f,e){var a={"./simpleWorker":18352,"./simpleWorker.js":18352};function s(o){return Promise.resolve().then(function(){if(!e.o(a,o)){var i=new Error("Cannot find module '"+o+"'");throw i.code="MODULE_NOT_FOUND",i}var _=a[o];return e(_)})}s.keys=function(){return Object.keys(a)},s.id=85674,y.exports=s},10131:function(y,f,e){var a={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[68997],"./semanticTokensProviderStyling.js":[68997],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function s(o){if(!e.o(a,o))return Promise.resolve().then(function(){var g=new Error("Cannot find module '"+o+"'");throw g.code="MODULE_NOT_FOUND",g});var i=a[o],_=i[0];return Promise.all(i.slice(1).map(e.e)).then(function(){return e(_)})}s.keys=function(){return Object.keys(a)},s.id=10131,y.exports=s}}]);
