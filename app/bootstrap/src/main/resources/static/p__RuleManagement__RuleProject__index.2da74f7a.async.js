(self.webpackChunk=self.webpackChunk||[]).push([[6673],{56477:function(U,P,e){"use strict";e.d(P,{Z:function(){return a}});var s=e(87462),f=e(62435),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},E=p,h=e(84089),u=function(c,O){return f.createElement(h.Z,(0,s.Z)({},c,{ref:O,icon:E}))},_=f.forwardRef(u),a=_},61011:function(U,P,e){"use strict";e.d(P,{Z:function(){return a}});var s=e(87462),f=e(62435),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M666.7 505.5l-246-178A8 8 0 00408 334v46.9c0 10.2 4.9 19.9 13.2 25.9L566.6 512 421.2 617.2c-8.3 6-13.2 15.6-13.2 25.9V690c0 6.5 7.4 10.3 12.7 6.5l246-178c4.4-3.2 4.4-9.8 0-13z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"right-circle",theme:"outlined"},E=p,h=e(84089),u=function(c,O){return f.createElement(h.Z,(0,s.Z)({},c,{ref:O,icon:E}))},_=f.forwardRef(u),a=_},86615:function(U,P,e){"use strict";var s=e(1413),f=e(91),p=e(22270),E=e(78045),h=e(62435),u=e(90789),_=e(69450),a=e(86074),j=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],c=h.forwardRef(function(R,S){var C=R.fieldProps,A=R.options,B=R.radioType,m=R.layout,i=R.proFieldProps,L=R.valueEnum,$=(0,f.Z)(R,j);return(0,a.jsx)(_.Z,(0,s.Z)((0,s.Z)({valueType:B==="button"?"radioButton":"radio",ref:S,valueEnum:(0,p.h)(L,void 0)},$),{},{fieldProps:(0,s.Z)({options:A,layout:m},C),proFieldProps:i,filedConfig:{customLightMode:!0}}))}),O=h.forwardRef(function(R,S){var C=R.fieldProps,A=R.children;return(0,a.jsx)(E.ZP,(0,s.Z)((0,s.Z)({},C),{},{ref:S,children:A}))}),v=(0,u.G)(O,{valuePropName:"checked",ignoreWidth:!0}),W=v;W.Group=c,W.Button=E.ZP.Button,W.displayName="ProFormComponent",P.Z=W},64317:function(U,P,e){"use strict";var s=e(1413),f=e(91),p=e(22270),E=e(62435),h=e(66758),u=e(69450),_=e(86074),a=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],j=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],c=function(C,A){var B=C.fieldProps,m=C.children,i=C.params,L=C.proFieldProps,$=C.mode,x=C.valueEnum,J=C.request,Y=C.showSearch,K=C.options,ne=(0,f.Z)(C,a),le=(0,E.useContext)(h.Z);return(0,_.jsx)(u.Z,(0,s.Z)((0,s.Z)({valueEnum:(0,p.h)(x),request:J,params:i,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,s.Z)({options:K,mode:$,showSearch:Y,getPopupContainer:le.getPopupContainer},B),ref:A,proFieldProps:L},ne),{},{children:m}))},O=E.forwardRef(function(S,C){var A=S.fieldProps,B=S.children,m=S.params,i=S.proFieldProps,L=S.mode,$=S.valueEnum,x=S.request,J=S.options,Y=(0,f.Z)(S,j),K=(0,s.Z)({options:J,mode:L||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},A),ne=(0,E.useContext)(h.Z);return(0,_.jsx)(u.Z,(0,s.Z)((0,s.Z)({valueEnum:(0,p.h)($),request:x,params:m,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,s.Z)({getPopupContainer:ne.getPopupContainer},K),ref:C,proFieldProps:i},Y),{},{children:B}))}),v=E.forwardRef(c),W=O,R=v;R.SearchSelect=W,R.displayName="ProFormComponent",P.Z=R},5966:function(U,P,e){"use strict";var s=e(97685),f=e(1413),p=e(91),E=e(21770),h=e(23323),u=e(55241),_=e(97435),a=e(62435),j=e(69450),c=e(86074),O=["fieldProps","proFieldProps"],v=["fieldProps","proFieldProps"],W="text",R=function(m){var i=m.fieldProps,L=m.proFieldProps,$=(0,p.Z)(m,O);return(0,c.jsx)(j.Z,(0,f.Z)({valueType:W,fieldProps:i,filedConfig:{valueType:W},proFieldProps:L},$))},S=function(m){var i=(0,E.Z)(m.open||!1,{value:m.open,onChange:m.onOpenChange}),L=(0,s.Z)(i,2),$=L[0],x=L[1];return(0,c.jsx)(h.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(Y){var K,ne=Y.getFieldValue(m.name||[]);return(0,c.jsx)(u.Z,(0,f.Z)((0,f.Z)({getPopupContainer:function(k){return k&&k.parentNode?k.parentNode:k},onOpenChange:function(k){return x(k)},content:(0,c.jsxs)("div",{style:{padding:"4px 0"},children:[(K=m.statusRender)===null||K===void 0?void 0:K.call(m,ne),m.strengthText?(0,c.jsx)("div",{style:{marginTop:10},children:(0,c.jsx)("span",{children:m.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},m.popoverProps),{},{open:$,children:m.children}))}})},C=function(m){var i=m.fieldProps,L=m.proFieldProps,$=(0,p.Z)(m,v),x=(0,a.useState)(!1),J=(0,s.Z)(x,2),Y=J[0],K=J[1];return i!=null&&i.statusRender&&$.name?(0,c.jsx)(S,{name:$.name,statusRender:i==null?void 0:i.statusRender,popoverProps:i==null?void 0:i.popoverProps,strengthText:i==null?void 0:i.strengthText,open:Y,onOpenChange:K,children:(0,c.jsx)("div",{children:(0,c.jsx)(j.Z,(0,f.Z)({valueType:"password",fieldProps:(0,f.Z)((0,f.Z)({},(0,_.Z)(i,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(le){var k;i==null||(k=i.onBlur)===null||k===void 0||k.call(i,le),K(!1)},onClick:function(le){var k;i==null||(k=i.onClick)===null||k===void 0||k.call(i,le),K(!0)}}),proFieldProps:L,filedConfig:{valueType:W}},$))})}):(0,c.jsx)(j.Z,(0,f.Z)({valueType:"password",fieldProps:i,proFieldProps:L,filedConfig:{valueType:W}},$))},A=R;A.Password=C,A.displayName="ProFormComponent",P.Z=A},90672:function(U,P,e){"use strict";var s=e(1413),f=e(91),p=e(62435),E=e(69450),h=e(86074),u=["fieldProps","proFieldProps"],_=function(j,c){var O=j.fieldProps,v=j.proFieldProps,W=(0,f.Z)(j,u);return(0,h.jsx)(E.Z,(0,s.Z)({ref:c,valueType:"textarea",fieldProps:O,proFieldProps:v},W))};P.Z=p.forwardRef(_)},31732:function(U,P,e){"use strict";var s=e(97857),f=e.n(s),p=e(66309),E=e(62435),h=e(86074);P.Z=function(u){var _=u.text,a=u.style;return(0,h.jsx)(p.Z,{style:f()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},a),children:_})}},24163:function(U,P,e){"use strict";var s=e(97857),f=e.n(s),p=e(25593),E=e(83062),h=e(62435),u=e(86074),_=p.Z.Paragraph;P.Z=function(a){var j=a.text,c=a.width,O=a.maxWidth,v=a.rows,W=v===void 0?2:v,R=a.placement,S=R===void 0?"top":R,C=a.color,A=C===void 0?"rgba(0, 0, 0, 0.88)":C,B=a.link,m=B===void 0?!1:B,i=a.onClickCallBackFunc,L=a.style,$=L===void 0?{}:L,x=a.copyable,J=x===void 0?!1:x;return(0,u.jsx)("div",{style:{maxWidth:O,width:c},children:(0,u.jsx)(E.Z,{title:(0,u.jsx)("div",{children:j}),placement:S,children:(0,u.jsx)(_,{ellipsis:{rows:W},style:f()({marginBottom:0,color:A,cursor:m?"pointer":""},$),onClick:i,copyable:J,children:j})})})}},28235:function(U,P,e){"use strict";var s=e(97857),f=e.n(s),p=e(25593),E=e(83062),h=e(62435),u=e(86074),_=p.Z.Paragraph;P.Z=function(a){var j=a.text,c=a.width,O=a.maxWidth,v=a.rows,W=v===void 0?2:v,R=a.placement,S=R===void 0?"top":R,C=a.color,A=C===void 0?"rgba(0, 0, 0, 0.88)":C,B=a.link,m=B===void 0?!1:B,i=a.onClickCallBackFunc,L=a.style,$=L===void 0?{}:L,x=a.copyable,J=x===void 0?!1:x,Y=a.tooltipText;return(0,u.jsx)("div",{style:{maxWidth:O,width:c},children:(0,u.jsx)(E.Z,{title:Y,placement:S,children:(0,u.jsx)(_,{ellipsis:{rows:W},style:f()({marginBottom:0,color:A,cursor:m?"pointer":""},$),onClick:i,copyable:J,children:j})})})}},7105:function(U,P,e){"use strict";e.r(P),e.d(P,{default:function(){return ve}});var s=e(13769),f=e.n(s),p=e(9783),E=e.n(p),h=e(97857),u=e.n(h),_=e(15009),a=e.n(_),j=e(99289),c=e.n(j),O=e(5574),v=e.n(O),W=e(31732),R=e(53846),S=e(24163),C=e(28235),A=e(79930),B=e(96655),m=e(94561),i=e(29448),L=e(86548),$=e(87462),x=e(62435),J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},Y=J,K=e(84089),ne=function(G,ue){return x.createElement(K.Z,(0,$.Z)({},G,{ref:ue,icon:Y}))},le=x.forwardRef(ne),k=le,Ke=e(56477),tt=e(61011),o=e(39380),y=e(93410),F=e(28189),d=e(92016),g=e(3303),ee=e(75302),z=e(68872),w=e(23323),V=e(83622),Ce=e(42075),ae=e(83062),ye=e(55241),me=e(86738),Le=e(72269),be=e(71230),Z=e(15746),je=e(84567),Me=e(34041),pe=e(96486),ze=e(37476),Oe=e(64317),Fe=e(97462),Ie=e(5966),q=e(86615),rt=e(90672),ot=e(57381),ke=e(32983),r=e(86074),we=function(G){var ue=(0,d.useModel)("rule"),Te=ue.platformList,at=ue.ruleGroupList,st=z.ZP.useMessage(),Je=v()(st,2),De=Je[0],Ae=Je[1],$e=w.Z.useForm(),We=v()($e,1),fe=We[0],Ne=(0,d.useIntl)(),Qe=(0,x.useState)([]),se=v()(Qe,2),it=se[0],ge=se[1],he=(0,x.useState)(!1),Ue=v()(he,2),ut=Ue[0],Xe=Ue[1],ie=G.editFormVisible,n=G.groupInfo,Ye=G.setEditFormVisible,qe=G.tableActionRef,dt=function(){var X=c()(a()().mark(function te(re){var de,oe,H,_e;return a()().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return de=u()({},re),n.id&&(de.id=n.id),Ee.next=4,(0,B.saveRule)(de);case 4:oe=Ee.sent,(oe.msg==="success"||[200].includes(oe.code))&&(n.id?De.success(Ne.formatMessage({id:"common.message.text.edit.success"})):De.success(Ne.formatMessage({id:"common.message.text.create.success"})),Ye(!1),(H=qe.current)===null||H===void 0||(_e=H.reloadAndRest)===null||_e===void 0||_e.call(H));case 6:case"end":return Ee.stop()}},te)}));return function(re){return X.apply(this,arguments)}}(),et=function(){var X=c()(a()().mark(function te(re){var de;return a()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(re.trim()){H.next=2;break}return H.abrupt("return");case 2:return Xe(!0),H.next=5,(0,A.queryTypeList)({platform:re});case 5:de=H.sent,Xe(!1),(0,pe.isEmpty)(de.content)?(De.error(Ne.formatMessage({id:"cloudAccount.message.text.no.assets"})),ge([])):ge(de.content);case 8:case"end":return H.stop()}},te)}));return function(re){return X.apply(this,arguments)}}();(0,x.useEffect)(function(){ie&&!(0,pe.isEmpty)(n)&&(fe.setFieldsValue(u()({},n)),n.platform&&et(n.platform))},[ie,n]);var ct=function(){fe.resetFields()},mt=function(){Ye(!1),ct()};return(0,r.jsxs)(r.Fragment,{children:[Ae,(0,r.jsxs)(ze.Y,{title:n.id?"\u7F16\u8F91\u89C4\u5219":"\u65B0\u5EFA\u89C4\u5219",width:640,labelCol:{span:4},wrapperCol:{span:20},form:fe,modalProps:{destroyOnClose:!0,onCancel:function(){return mt()}},layout:"horizontal",open:ie,onFinish:dt,children:[(0,r.jsx)(Oe.Z,{label:"\u5E73\u53F0",name:"platform",placeholder:"\u8BF7\u9009\u62E9\u5E73\u53F0",rules:[{required:!0}],options:Te||[],onChange:function(){var X=c()(a()().mark(function te(re){return a()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.next=2,et(re);case 2:fe.setFieldValue("resourceType",null);case 3:case"end":return oe.stop()}},te)}));return function(te){return X.apply(this,arguments)}}()}),(0,r.jsx)(Fe.Z,{name:["platform"],children:function(te){var re=te.platform;return(0,pe.isEmpty)(re)?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)(Oe.Z,{label:"\u8D44\u4EA7\u7C7B\u578B",name:"resourceType",placeholder:"\u8BF7\u9009\u62E9\u8D44\u4EA7\u7C7B\u578B",options:it||[],fieldProps:{fieldNames:{label:"resourceName",value:"resourceType"},showSearch:!0,filterOption:!0,notFoundContent:ut?(0,r.jsx)(ot.Z,{size:"small"}):(0,r.jsx)(ke.Z,{image:ke.Z.PRESENTED_IMAGE_SIMPLE})},rules:[{required:!0}]})}}),(0,r.jsx)(Oe.Z,{label:"\u89C4\u5219\u7EC4",name:"ruleGroupId",placeholder:"\u8BF7\u9009\u62E9\u89C4\u5219\u7EC4",rules:[{required:!0}],options:at||[]}),(0,r.jsx)(Ie.Z,{name:"ruleName",label:"\u89C4\u5219\u540D\u79F0",rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u89C4\u5219\u540D\u79F0"}),(0,r.jsx)(Ie.Z,{name:"ruleDesc",label:"\u89C4\u5219\u63CF\u8FF0",rules:[{required:!0}],placeholder:"\u8BF7\u8F93\u5165\u89C4\u5219\u63CF\u8FF0"}),(0,r.jsx)(q.Z.Group,{name:"riskLevel",label:"\u98CE\u9669\u7B49\u7EA7",rules:[{required:!0}],initialValue:"Low",options:(m.I9===null||m.I9===void 0?void 0:m.I9.map(function(X){return{label:X.text,value:X.value}}))||[]}),(0,r.jsx)(rt.Z,{name:"advice",label:"\u4FEE\u590D\u5EFA\u8BAE",placeholder:"\u8BF7\u8F93\u5165\u4FEE\u590D\u5EFA\u8BAE"}),(0,r.jsx)(Ie.Z,{name:"link",label:"\u53C2\u8003\u94FE\u63A5",placeholder:"\u8BF7\u8F93\u5165\u53C2\u8003\u94FE\u63A5",rules:[{pattern:new RegExp("^(https?|ftp):\\/\\/[^\\s/$.?#].[^\\s]*$","i"),message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u94FE\u63A5"}]})]})]})},nt=we,Q=e(61194),Ve=["pageSize","current"],Ge=g.Z.SHOW_CHILD,He=ee.ZP.useBreakpoint,Pe=function(G,ue){var Te;return(Te=ue.label)===null||Te===void 0?void 0:Te.includes(G)},lt=function(){var G=(0,d.useModel)("rule"),ue=G.platformList,Te=G.ruleTypeList,at=G.allRuleList,st=G.ruleGroupList,Je=(0,d.useLocation)(),De=Je.search,Ae=new URLSearchParams(De),$e=Ae.get("groupId"),We=Ae.get("ruleCode"),fe=Ae.get("platform"),Ne=z.ZP.useMessage(),Qe=v()(Ne,2),se=Qe[0],it=Qe[1],ge=He(),he=(0,x.useRef)(),Ue=(0,x.useRef)(),ut=w.Z.useForm(),Xe=v()(ut,1),ie=Xe[0],n=(0,d.useIntl)(),Ye=(0,x.useState)(!1),qe=v()(Ye,2),dt=qe[0],et=qe[1],ct=(0,x.useRef)({}),mt=(0,x.useState)(),X=v()(mt,2),te=X[0],re=X[1],de=(0,x.useState)({}),oe=v()(de,2),H=oe[0],_e=oe[1],ht=(0,x.useState)({}),Ee=v()(ht,2),pt=Ee[0],xt=Ee[1],Mt=(0,x.useState)(!1),Ct=v()(Mt,2),Tt=Ct[0],Pt=Ct[1],Rt=(0,x.useState)({lastScanTime:{show:!1},groupName:{show:!1},gmtCreated:{show:!1}}),bt=v()(Rt,1),jt=bt[0],Ot=function(l){return l.id===te?"ant-table-row-selected":""},Zt=(0,x.useState)([]),Et=v()(Zt,2),_t=Et[0],vt=Et[1],St=(0,d.useRequest)(function(M){return(0,A.queryGroupTypeList)({platformList:M})},{manual:!0,formatResult:function(l){var t=l.content;vt(t||[])}}),ft=St.run,Bt=function(){var M=c()(a()().mark(function l(t){var T,N,I,D;return a()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return T=se.loading(n.formatMessage({id:"common.message.text.delete.loading"})),b.next=3,(0,B.deleteRule)({id:t});case 3:N=b.sent,T(),(N.code===200||N.msg==="success")&&(se.success(n.formatMessage({id:"common.message.text.delete.success"})),(I=he.current)===null||I===void 0||(D=I.reloadAndRest)===null||D===void 0||D.call(I));case 6:case"end":return b.stop()}},l)}));return function(t){return M.apply(this,arguments)}}(),Lt=function(){var M=c()(a()().mark(function l(t){var T,N,I,D;return a()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return _e(u()(u()({},H),{},E()({},t,!0))),T=se.loading(n.formatMessage({id:"common.message.text.execute.loading"})),b.next=4,(0,B.scanByRule)({id:t});case 4:N=b.sent,_e(u()(u()({},H),{},E()({},t,!1))),T(),(N.code===200||N.msg==="success")&&(se.success(n.formatMessage({id:"common.message.text.execute.success"})),(I=he.current)===null||I===void 0||(D=I.reloadAndRest)===null||D===void 0||D.call(I));case 8:case"end":return b.stop()}},l)}));return function(t){return M.apply(this,arguments)}}(),Ft=function(){var M=c()(a()().mark(function l(t){var T,N,I,D;return a()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return xt(u()(u()({},pt),{},E()({},t,!0))),T=se.loading(n.formatMessage({id:"common.message.text.copy.loading"})),b.next=4,(0,B.copyRule)({id:t});case 4:N=b.sent,xt(u()(u()({},pt),{},E()({},t,!1))),T(),(N.code===200||N.msg==="success")&&(se.success(n.formatMessage({id:"common.message.text.copy.success"})),(I=he.current)===null||I===void 0||(D=I.reloadAndRest)===null||D===void 0||D.call(I));case 8:case"end":return b.stop()}},l)}));return function(t){return M.apply(this,arguments)}}(),It=function(){var M=c()(a()().mark(function l(t,T){var N,I,D,xe;return a()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return N={id:t,status:T},ce.next=3,(0,B.changeRuleStatus)(N);case 3:I=ce.sent,(I.code===200||I.msg==="success")&&(se.success(n.formatMessage({id:"common.message.text.edit.success"})),(D=he.current)===null||D===void 0||(xe=D.reloadAndRest)===null||xe===void 0||xe.call(D));case 5:case"end":return ce.stop()}},l)}));return function(t,T){return M.apply(this,arguments)}}(),Dt=function(){Pt(!0),(0,B.queryExportRuleList)({},{responseType:"blob"}).then(function(l){(0,i.a5)(l,"CloudRec ".concat(n.formatMessage({id:"rule.module.text.rule.data"}))),se.success(n.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return Pt(!1)})};(0,x.useEffect)(function(){(0,pe.isEmpty)($e)||ie.setFieldValue("ruleGroupIdList",[Number($e)]),(0,pe.isEmpty)(We)||ie.setFieldValue("ruleCodeList",[We]),(0,pe.isEmpty)(fe)||(ie.setFieldValue("platformList",[fe]),ft([fe]))},[$e,We,fe]);var At=[{title:n.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(l,t){var T;return(0,r.jsxs)("div",{children:[(0,r.jsx)(C.Z,{placement:"topLeft",maxWidth:ge!=null&&ge.xxl?600:400,rows:1,text:(t==null?void 0:t.ruleName)||"-",tooltipText:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[n.formatMessage({id:"rule.module.text.rule.code"}),"\xA0: ",(t==null?void 0:t.ruleCode)||"-"]}),(0,r.jsxs)("div",{children:[n.formatMessage({id:"home.module.inform.columns.ruleName"}),"\xA0: ",(t==null?void 0:t.ruleName)||"-"]}),(0,r.jsxs)("div",{children:[n.formatMessage({id:"rule.module.text.rule.describe"}),"\xA0: ",(t==null?void 0:t.ruleDesc)||"-"]})]}),style:{fontWeight:500,color:"rgb(58, 58, 58)"}}),(0,r.jsx)(S.Z,{placement:"topLeft",maxWidth:ge!=null&&ge.xxl?600:400,rows:1,text:(t==null||(T=t.ruleTypeNameList)===null||T===void 0?void 0:T.toString())||"-",style:{color:"rgb(166, 167, 167)",fontSize:13}})]})}},{title:n.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeStr",valueType:"text",align:"left",hideInSearch:!0,render:function(l,t){return(0,r.jsx)(W.Z,{text:(t==null?void 0:t.resourceTypeStr)||"-"})}},{title:n.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"select",valueEnum:(0,i.W_)(m.I9),align:"center",hideInSearch:!0,render:function(l,t){return(0,i.Dd)(m.I9,t==null?void 0:t.riskLevel)}},{title:n.formatMessage({id:"common.table.columns.platform"}),dataIndex:"platform",valueType:"select",valueEnum:(0,i.W_)(ue),align:"center",hideInSearch:!0,render:function(l,t){return(0,i.c5)(t.platform,ue)},fieldProps:{onChange:function(l){var t;(t=Ue.current)===null||t===void 0||t.setFieldValue("resourceTypeList",null),vt([]),ft(l)}}},{title:n.formatMessage({id:"asset.module.risk.number"}),dataIndex:"riskCount",valueType:"text",hideInSearch:!0,align:"center",sorter:!0,render:function(l,t){return(0,r.jsx)(V.ZP,{type:"link",size:"small",href:"/riskManagement/riskList?platform=".concat(t==null?void 0:t.platform,"&ruleCode=").concat(t==null?void 0:t.ruleCode," "),children:t==null?void 0:t.riskCount})}},{title:n.formatMessage({id:"rule.input.text.rule.group.creator"}),dataIndex:"username",valueType:"text",hideInSearch:!0,width:120},{title:n.formatMessage({id:"common.table.columns.last.scan.time"}),dataIndex:"lastScanTime",valueType:"dateTime",hideInSearch:!0,align:"left",width:160},{title:n.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"groupName",valueType:"text",align:"left",hideInSearch:!0,width:240,render:function(l,t){var T;return(0,r.jsx)(S.Z,{placement:"topLeft",maxWidth:220,rows:2,text:(t==null||(T=t.ruleGroupNameList)===null||T===void 0?void 0:T.toString())||"-",style:{color:"rgb(51, 51, 51)"}})}},{title:n.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(l,t){return(0,r.jsxs)("div",{children:[(0,r.jsx)("section",{style:{color:"#999"},children:(t==null?void 0:t.gmtCreate)||"-"}),(0,r.jsx)("section",{style:{color:"#999"},children:(t==null?void 0:t.gmtModified)||"-"})]})}},{title:n.formatMessage({id:"common.table.columns.rule.status"}),dataIndex:"status",hideInTable:!0,valueEnum:{valid:n.formatMessage({id:"common.button.text.enable"}),invalid:n.formatMessage({id:"common.button.text.disable"})}},{title:n.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(l,t){return(0,r.jsxs)(Ce.Z,{size:"small",children:[(0,r.jsx)(V.ZP,{size:"small",onClick:function(){return re(t.id)},type:"link",target:"_self",href:"/ruleManagement/ruleProject/edit?id=".concat(t==null?void 0:t.id),children:(0,r.jsx)(ae.Z,{title:n.formatMessage({id:"common.button.text.edit"}),children:(0,r.jsx)(L.Z,{})})}),(0,r.jsx)(ye.Z,{content:(0,r.jsxs)(Ce.Z,{children:[(0,r.jsx)(me.Z,{title:n.formatMessage({id:"common.button.text.delete.confirm"}),onConfirm:function(){return Bt(t.id)},okText:n.formatMessage({id:"common.button.text.ok"}),cancelText:n.formatMessage({id:"common.button.text.cancel"}),children:(0,r.jsx)(V.ZP,{block:!0,type:"link",danger:!0,size:"small",children:n.formatMessage({id:"common.button.text.delete"})})}),(0,r.jsx)(V.ZP,{block:!0,loading:H[Number(t.id)],onClick:function(){return Lt(t.id)},type:"link",target:"_blank",size:"small",children:n.formatMessage({id:"common.button.text.test"})}),(0,r.jsx)(V.ZP,{block:!0,loading:pt[Number(t.id)],onClick:function(){return Ft(t.id)},type:"link",target:"_blank",size:"small",children:n.formatMessage({id:"common.button.text.copy"})})]}),children:(0,r.jsx)(V.ZP,{type:"link",icon:(0,r.jsx)(k,{})})}),(0,r.jsx)(ae.Z,{title:n.formatMessage({id:"rule.module.text.tooltip.status"}),children:(0,r.jsx)(Le.Z,{checkedChildren:n.formatMessage({id:"common.button.text.enable"}),unCheckedChildren:n.formatMessage({id:"common.button.text.disable"}),checked:(t==null?void 0:t.status)==="valid",onClick:function(){return It(t.id,(t==null?void 0:t.status)==="valid"?"invalid":"valid")}})})]})}}];return(0,r.jsxs)(o._z,{ghost:!0,title:!1,className:Q.Z.rulePageContainer,breadcrumbRender:!1,children:[it,(0,r.jsx)(y.Z,{bodyStyle:{paddingBottom:0},className:Q.Z.customFilterCard,children:(0,r.jsx)(w.Z,{form:ie,children:(0,r.jsxs)(be.Z,{gutter:[24,10],children:[(0,r.jsx)(Z.Z,{span:24,children:(0,r.jsx)(w.Z.Item,{name:"platformList",label:n.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,r.jsx)(je.Z.Group,{options:(0,i.T$)(ue),onChange:function(l){ie.setFieldValue("resourceTypeList",null),vt([]),ft(l)}})})}),(0,r.jsx)(Z.Z,{span:24,children:(0,r.jsx)(w.Z.Item,{name:"riskLevelList",label:n.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,r.jsx)(je.Z.Group,{options:(0,i.at)(m.I9)})})}),(0,r.jsx)(Z.Z,{span:6,children:(0,r.jsx)(w.Z.Item,{name:"ruleCodeList",label:n.formatMessage({id:"home.module.inform.columns.ruleName"}),style:{marginBottom:0},children:(0,r.jsx)(Me.Z,{filterOption:Pe,placeholder:n.formatMessage({id:"common.select.text.placeholder"}),allowClear:!0,options:at,mode:"multiple"})})}),(0,r.jsx)(Z.Z,{span:6,children:(0,r.jsx)(w.Z.Item,{name:"resourceTypeList",label:n.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,r.jsx)(g.Z,{options:_t,multiple:!0,placeholder:n.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:Ge,allowClear:!0,showSearch:!0})})}),(0,r.jsx)(Z.Z,{span:6,children:(0,r.jsx)(w.Z.Item,{name:"ruleGroupIdList",label:n.formatMessage({id:"layout.routes.title.ruleGroup"}),style:{marginBottom:0,width:"100%"},children:(0,r.jsx)(Me.Z,{placeholder:n.formatMessage({id:"common.select.text.placeholder"}),options:st,allowClear:!0,mode:"multiple"})})}),(0,r.jsx)(Z.Z,{span:6,children:(0,r.jsx)(w.Z.Item,{name:"ruleTypeIdList",label:n.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),style:{marginBottom:0,width:"100%"},children:(0,r.jsx)(g.Z,{placeholder:n.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:Ge,allowClear:!0,showSearch:!0,fieldNames:{label:"typeName",value:"id",children:"childList"},multiple:!0,options:Te||[]})})})]})})}),(0,r.jsx)(F.Z,{scroll:{x:"max-content"},headerTitle:(0,r.jsx)("div",{className:R.Z.customTitle,children:n.formatMessage({id:"rule.module.text.rule.inquiry"})}),actionRef:he,formRef:Ue,rowClassName:Ot,rowKey:"id",search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},toolBarRender:function(){return[(0,r.jsx)(V.ZP,{type:"primary",href:"/ruleManagement/ruleProject/edit",children:n.formatMessage({id:"rule.extend.basic.add"})},"CREATE"),(0,r.jsx)(V.ZP,{loading:Tt,type:"primary",onClick:Dt,children:n.formatMessage({id:"common.button.text.export"})},"EXPORT")]},request:function(){var M=c()(a()().mark(function l(t,T){var N,I,D,xe,b,ce,Se,gt,Re,yt;return a()().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return N=t.pageSize,I=t.current,D=f()(t,Ve),xe=ie.getFieldsValue(),b=(0,i.Hm)(T),ce=u()(u()(u()({},D),xe),{},{page:I,size:N}),(0,pe.isEmpty)(b)||(ce.sortParam=b==null?void 0:b.key,ce.sortType=b==null||(Se=b.value)===null||Se===void 0||(Se=Se.slice(0,-3))===null||Se===void 0?void 0:Se.toUpperCase()),Be.next=7,(0,B.queryRuleList)(ce);case 7:return gt=Be.sent,Re=gt.content,yt=gt.code,Be.abrupt("return",{data:(Re==null?void 0:Re.data)||[],total:(Re==null?void 0:Re.total)||0,success:yt===200||!1});case 11:case"end":return Be.stop()}},l)}));return function(l,t){return M.apply(this,arguments)}}(),onReset:function(){var l;ie.resetFields(),(l=he.current)===null||l===void 0||l.reloadAndRest()},columns:At,columnsState:{defaultValue:jt,persistenceType:"localStorage",persistenceKey:"RULE_TABLE_LIST_CACHE"},pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1},expandable:{expandedRowRender:function(l){return(0,r.jsxs)(be.Z,{children:[(0,r.jsx)(Z.Z,{span:3,className:Q.Z.dimBlock,style:{borderLeft:"0.5px solid rgb(239, 239, 239)",borderBottom:"none"},children:n.formatMessage({id:"home.module.inform.columns.ruleName"})}),(0,r.jsx)(Z.Z,{span:9,className:Q.Z.cleanBlock,style:{borderBottom:"none"},children:(l==null?void 0:l.ruleName)||"-"}),(0,r.jsx)(Z.Z,{span:3,className:Q.Z.dimBlock,style:{borderBottom:"none"},children:n.formatMessage({id:"rule.module.text.rule.describe"})}),(0,r.jsx)(Z.Z,{span:9,className:Q.Z.cleanBlock,style:{borderBottom:"none"},children:(l==null?void 0:l.ruleDesc)||"-"}),(0,r.jsx)(Z.Z,{span:3,className:Q.Z.dimBlock,style:{borderLeft:"0.5px solid rgb(239, 239, 239)"},children:n.formatMessage({id:"rule.module.text.repair.suggestions"})}),(0,r.jsx)(Z.Z,{span:5,className:Q.Z.cleanBlock,style:{flexDirection:"column"},children:(0,r.jsx)("div",{children:(l==null?void 0:l.advice)||"-"})}),(0,r.jsx)(Z.Z,{span:3,className:Q.Z.dimBlock,children:n.formatMessage({id:"rule.module.text.reference.link"})}),(0,r.jsx)(Z.Z,{span:5,className:Q.Z.cleanBlock,children:(0,r.jsx)("a",{type:"link",href:l==null?void 0:l.link,target:"_blank",rel:"noreferrer",className:Q.Z.lineBreak,children:(l==null?void 0:l.link)||"-"})}),(0,r.jsx)(Z.Z,{span:3,className:Q.Z.dimBlock,children:n.formatMessage({id:"rule.module.text.risk.context.template"})}),(0,r.jsx)(Z.Z,{span:5,className:Q.Z.cleanBlock,children:(l==null?void 0:l.context)||"-"})]})},columnTitle:(0,r.jsx)("div",{style:{width:30,textAlign:"center"}}),columnWidth:30,rowExpandable:function(){return!0},expandIcon:function(l){var t=l.expanded,T=l.onExpand,N=l.record;return t?(0,r.jsx)(Ke.Z,{style:{color:"#457aff",fontSize:14},onClick:function(D){return T(N,D)}}):(0,r.jsx)(tt.Z,{style:{color:"#457aff",fontSize:14},onClick:function(D){return T(N,D)}})}}}),(0,r.jsx)(nt,{editFormVisible:dt,setEditFormVisible:et,groupInfo:ct.current,tableActionRef:he})]})},ve=lt},53846:function(U,P){"use strict";P.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},61194:function(U,P){"use strict";P.Z={floatButton:"floatButton___c4Q61",ruleEditPageContainer:"ruleEditPageContainer___JtP7R",stepListMain:"stepListMain___MjGkn",stepsWrap:"stepsWrap___GXD6m",contentMainTransparent:"contentMainTransparent___KcrOp",contentMain:"contentMain___zT9JY",ruleEditPageContainerSpecial:"ruleEditPageContainerSpecial___JGb_t",rulePageContainer:"rulePageContainer___p2US0",customFilterCard:"customFilterCard___A5TQf",customTitle:"customTitle___k1LUC",cleanBlock:"cleanBlock___et5AN",dimBlock:"dimBlock___EvyJb",lineBreak:"lineBreak___Oybab"}},75302:function(U,P,e){"use strict";var s=e(25378);function f(){return(0,s.Z)()}P.ZP={useBreakpoint:f}},66309:function(U,P,e){"use strict";e.d(P,{Z:function(){return tt}});var s=e(62435),f=e(93967),p=e.n(f),E=e(98423),h=e(98787),u=e(69760),_=e(96159),a=e(45353),j=e(53124),c=e(861),O=e(15063),v=e(14747),W=e(83262),R=e(83559);const S=o=>{const{paddingXXS:y,lineWidth:F,tagPaddingHorizontal:d,componentCls:g,calc:ee}=o,z=ee(d).sub(F).equal(),w=ee(y).sub(F).equal();return{[g]:Object.assign(Object.assign({},(0,v.Wf)(o)),{display:"inline-block",height:"auto",marginInlineEnd:o.marginXS,paddingInline:z,fontSize:o.tagFontSize,lineHeight:o.tagLineHeight,whiteSpace:"nowrap",background:o.defaultBg,border:`${(0,c.unit)(o.lineWidth)} ${o.lineType} ${o.colorBorder}`,borderRadius:o.borderRadiusSM,opacity:1,transition:`all ${o.motionDurationMid}`,textAlign:"start",position:"relative",[`&${g}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:o.defaultColor},[`${g}-close-icon`]:{marginInlineStart:w,fontSize:o.tagIconSize,color:o.colorTextDescription,cursor:"pointer",transition:`all ${o.motionDurationMid}`,"&:hover":{color:o.colorTextHeading}},[`&${g}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${o.iconCls}-close, ${o.iconCls}-close:hover`]:{color:o.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${g}-checkable-checked):hover`]:{color:o.colorPrimary,backgroundColor:o.colorFillSecondary},"&:active, &-checked":{color:o.colorTextLightSolid},"&-checked":{backgroundColor:o.colorPrimary,"&:hover":{backgroundColor:o.colorPrimaryHover}},"&:active":{backgroundColor:o.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${o.iconCls} + span, > span + ${o.iconCls}`]:{marginInlineStart:z}}),[`${g}-borderless`]:{borderColor:"transparent",background:o.tagBorderlessBg}}},C=o=>{const{lineWidth:y,fontSizeIcon:F,calc:d}=o,g=o.fontSizeSM;return(0,W.mergeToken)(o,{tagFontSize:g,tagLineHeight:(0,c.unit)(d(o.lineHeightSM).mul(g).equal()),tagIconSize:d(F).sub(d(y).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:o.defaultBg})},A=o=>({defaultBg:new O.FastColor(o.colorFillQuaternary).onBackground(o.colorBgContainer).toHexString(),defaultColor:o.colorText});var B=(0,R.I$)("Tag",o=>{const y=C(o);return S(y)},A),m=function(o,y){var F={};for(var d in o)Object.prototype.hasOwnProperty.call(o,d)&&y.indexOf(d)<0&&(F[d]=o[d]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,d=Object.getOwnPropertySymbols(o);g<d.length;g++)y.indexOf(d[g])<0&&Object.prototype.propertyIsEnumerable.call(o,d[g])&&(F[d[g]]=o[d[g]]);return F},L=s.forwardRef((o,y)=>{const{prefixCls:F,style:d,className:g,checked:ee,onChange:z,onClick:w}=o,V=m(o,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:Ce,tag:ae}=s.useContext(j.E_),ye=Me=>{z==null||z(!ee),w==null||w(Me)},me=Ce("tag",F),[Le,be,Z]=B(me),je=p()(me,`${me}-checkable`,{[`${me}-checkable-checked`]:ee},ae==null?void 0:ae.className,g,be,Z);return Le(s.createElement("span",Object.assign({},V,{ref:y,style:Object.assign(Object.assign({},d),ae==null?void 0:ae.style),className:je,onClick:ye})))}),$=e(98719);const x=o=>(0,$.Z)(o,(y,F)=>{let{textColor:d,lightBorderColor:g,lightColor:ee,darkColor:z}=F;return{[`${o.componentCls}${o.componentCls}-${y}`]:{color:d,background:ee,borderColor:g,"&-inverse":{color:o.colorTextLightSolid,background:z,borderColor:z},[`&${o.componentCls}-borderless`]:{borderColor:"transparent"}}}});var J=(0,R.bk)(["Tag","preset"],o=>{const y=C(o);return x(y)},A);function Y(o){return typeof o!="string"?o:o.charAt(0).toUpperCase()+o.slice(1)}const K=(o,y,F)=>{const d=Y(F);return{[`${o.componentCls}${o.componentCls}-${y}`]:{color:o[`color${F}`],background:o[`color${d}Bg`],borderColor:o[`color${d}Border`],[`&${o.componentCls}-borderless`]:{borderColor:"transparent"}}}};var ne=(0,R.bk)(["Tag","status"],o=>{const y=C(o);return[K(y,"success","Success"),K(y,"processing","Info"),K(y,"error","Error"),K(y,"warning","Warning")]},A),le=function(o,y){var F={};for(var d in o)Object.prototype.hasOwnProperty.call(o,d)&&y.indexOf(d)<0&&(F[d]=o[d]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,d=Object.getOwnPropertySymbols(o);g<d.length;g++)y.indexOf(d[g])<0&&Object.prototype.propertyIsEnumerable.call(o,d[g])&&(F[d[g]]=o[d[g]]);return F};const Ke=s.forwardRef((o,y)=>{const{prefixCls:F,className:d,rootClassName:g,style:ee,children:z,icon:w,color:V,onClose:Ce,bordered:ae=!0,visible:ye}=o,me=le(o,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:Le,direction:be,tag:Z}=s.useContext(j.E_),[je,Me]=s.useState(!0),pe=(0,E.Z)(me,["closeIcon","closable"]);s.useEffect(()=>{ye!==void 0&&Me(ye)},[ye]);const ze=(0,h.o2)(V),Oe=(0,h.yT)(V),Fe=ze||Oe,Ie=Object.assign(Object.assign({backgroundColor:V&&!Fe?V:void 0},Z==null?void 0:Z.style),ee),q=Le("tag",F),[rt,ot,ke]=B(q),r=p()(q,Z==null?void 0:Z.className,{[`${q}-${V}`]:Fe,[`${q}-has-color`]:V&&!Fe,[`${q}-hidden`]:!je,[`${q}-rtl`]:be==="rtl",[`${q}-borderless`]:!ae},d,g,ot,ke),we=Pe=>{Pe.stopPropagation(),Ce==null||Ce(Pe),!Pe.defaultPrevented&&Me(!1)},[,nt]=(0,u.Z)((0,u.w)(o),(0,u.w)(Z),{closable:!1,closeIconRender:Pe=>{const lt=s.createElement("span",{className:`${q}-close-icon`,onClick:we},Pe);return(0,_.wm)(Pe,lt,ve=>({onClick:Ze=>{var G;(G=ve==null?void 0:ve.onClick)===null||G===void 0||G.call(ve,Ze),we(Ze)},className:p()(ve==null?void 0:ve.className,`${q}-close-icon`)}))}}),Q=typeof me.onClick=="function"||z&&z.type==="a",Ve=w||null,Ge=Ve?s.createElement(s.Fragment,null,Ve,z&&s.createElement("span",null,z)):z,He=s.createElement("span",Object.assign({},pe,{ref:y,className:r,style:Ie}),Ge,nt,ze&&s.createElement(J,{key:"preset",prefixCls:q}),Oe&&s.createElement(ne,{key:"status",prefixCls:q}));return rt(Q?s.createElement(a.Z,{component:"Tag"},He):He)});Ke.CheckableTag=L;var tt=Ke},64599:function(U,P,e){var s=e(96263);function f(p,E){var h=typeof Symbol!="undefined"&&p[Symbol.iterator]||p["@@iterator"];if(!h){if(Array.isArray(p)||(h=s(p))||E&&p&&typeof p.length=="number"){h&&(p=h);var u=0,_=function(){};return{s:_,n:function(){return u>=p.length?{done:!0}:{done:!1,value:p[u++]}},e:function(v){throw v},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,j=!1,c;return{s:function(){h=h.call(p)},n:function(){var v=h.next();return a=v.done,v},e:function(v){j=!0,c=v},f:function(){try{!a&&h.return!=null&&h.return()}finally{if(j)throw c}}}}U.exports=f,U.exports.__esModule=!0,U.exports.default=U.exports}}]);
