"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7530],{31732:function(Ee,O,t){var F=t(97857),m=t.n(F),P=t(66309),h=t(62435),N=t(86074);O.Z=function(x){var k=x.text,d=x.style;return(0,N.jsx)(P.Z,{style:m()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},d),children:k})}},28235:function(Ee,O,t){var F=t(97857),m=t.n(F),P=t(25593),h=t(83062),N=t(62435),x=t(86074),k=P.Z.Paragraph;O.Z=function(d){var D=d.text,c=d.width,g=d.maxWidth,S=d.rows,G=S===void 0?2:S,s=d.placement,V=s===void 0?"top":s,ee=d.color,te=ee===void 0?"rgba(0, 0, 0, 0.88)":ee,b=d.link,w=b===void 0?!1:b,oe=d.onClickCallBackFunc,se=d.style,ue=se===void 0?{}:se,$=d.copyable,A=$===void 0?!1:$,R=d.tooltipText;return(0,x.jsx)("div",{style:{maxWidth:g,width:c},children:(0,x.jsx)(h.Z,{title:R,placement:V,children:(0,x.jsx)(k,{ellipsis:{rows:G},style:m()({marginBottom:0,color:te,cursor:w?"pointer":""},ue),onClick:oe,copyable:A,children:D})})})}},92086:function(Ee,O,t){var F=t(5574),m=t.n(F),P=t(87426),h=t(39421),N=t(24163),x=t(71448),k=t(24482),d=t(50322),D=t(22145),c=t(96364),g=t(72028),S=t(29448),G=t(45742),s=t(93410),V=t(92016),ee=t(25593),te=t(85265),b=t(86250),w=t(83622),oe=t(42075),se=t(66309),ue=t(83062),$=t(21532),A=t(23323),R=t(62435),f=t(47908),a=t(86074),W=ee.Z.Text,Se=function(Q){var de,Z,M,ce,me,ge,ve=Q.riskDrawerVisible,T=Q.riskDrawerInfo,be=Q.setRiskDrawerVisible,fe=Q.locate,ke=(0,V.useModel)("rule"),we=ke.platformList,z=(0,V.useModel)("tenant"),re=z.tenantListAll,L=(0,V.useIntl)(),Ze=(0,R.useState)(!1),he=m()(Ze,2),Ae=he[0],Te=he[1],Be=(0,R.useState)(!1),xe=m()(Be,2),Fe=xe[0],Le=xe[1],Me=function(){be(!1)},p=(0,V.useRequest)(function(y){return(0,g.queryRiskDetailById)({riskId:y})},{manual:!0,formatResult:function(De){return De.content||{}}}),r=p.data,B=p.run,ne=p.loading,Ie=function(){Me()};return(0,R.useEffect)(function(){ve&&T!==null&&T!==void 0&&T.id&&B(T.id)},[ve,T]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(te.Z,{title:L.formatMessage({id:"risk.module.text.detail.info"}),width:"50%",open:ve,onClose:Ie,loading:ne,children:[(0,a.jsxs)(s.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,a.jsx)(b.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,a.jsxs)("span",{children:[(0,a.jsx)(W,{style:{marginRight:12},children:(0,a.jsx)(w.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(r==null?void 0:r.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(r==null||(de=r.ruleVO)===null||de===void 0?void 0:de.ruleName)||"-"})}),(0,a.jsxs)(oe.Z,{children:[(0,a.jsx)("span",{children:(0,S.Ff)(c.MW,r==null?void 0:r.status)}),(r==null?void 0:r.ignoreReasonType)&&(0,a.jsxs)("span",{children:[(0,a.jsxs)(W,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[L.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,a.jsx)(se.Z,{color:"geekblue",children:((Z=c.$G.find(function(y){return y.value===(r==null?void 0:r.ignoreReasonType)}))===null||Z===void 0?void 0:Z.label)||"-"})]}),(r==null?void 0:r.ignoreReason)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(W,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[L.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,a.jsx)(N.Z,{rows:1,text:r==null?void 0:r.ignoreReason,maxWidth:64})]})]})]})}),(0,a.jsxs)(b.Z,{vertical:!0,gap:10,children:[(0,a.jsxs)(b.Z,{align:"center",children:[(0,a.jsx)("img",{src:h.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,a.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[L.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,a.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:r==null?void 0:r.gmtModified})]}),(0,a.jsxs)(W,{children:[(0,a.jsx)("img",{src:P.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,a.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[L.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,a.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:r==null?void 0:r.gmtCreate})]})]}),(0,a.jsxs)(b.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,a.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,S.fD)(r==null?void 0:r.platform,we)}),(0,a.jsx)(W,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(r==null?void 0:r.resourceType)||"-"}),(0,a.jsxs)(b.Z,{align:"center",children:[(0,a.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(r==null?void 0:r.resourceName)+" / "+(r==null?void 0:r.resourceId)}),fe==="risk"&&(0,a.jsx)(ue.Z,{title:L.formatMessage({id:"asset.extend.text.detail"}),children:(0,a.jsx)("span",{className:f.Z.iconWrap,onClick:function(){return Le(!0)},children:(0,a.jsx)(G.Z,{className:f.Z.resourceInstance})})})]}),(0,a.jsx)(W,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(re==null||(M=re.find(function(y){return y.value===(r==null?void 0:r.tenantId)}))===null||M===void 0?void 0:M.label)||"-"})]})]}),(0,a.jsx)($.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,a.jsxs)(A.Z,{children:[(0,a.jsx)(A.Z.Item,{label:L.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(ce=r.ruleVO)===null||ce===void 0?void 0:ce.advice)||"-"})}),(0,a.jsx)(A.Z.Item,{label:L.formatMessage({id:"risk.module.text.reference.link"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(me=r.ruleVO)===null||me===void 0?void 0:me.link)||"-"})}),(0,a.jsx)(A.Z.Item,{label:L.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,a.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(r==null||(ge=r.ruleVO)===null||ge===void 0?void 0:ge.ruleDesc)||"-"})})]})}),(0,a.jsx)(x.Z,{riskDrawerInfo:T}),(0,a.jsx)(d.Z,{riskDrawerInfo:T})]}),(0,a.jsx)(k.Z,{evaluateDrawerVisible:Ae,setEvaluateDrawerVisible:Te,riskDrawerInfo:T}),(0,a.jsx)(D.Z,{resourceDrawerVisible:Fe,setResourceDrawerVisible:Le,riskDrawerInfo:T})]})};O.Z=Se},40351:function(Ee,O,t){t.r(O),t.d(O,{default:function(){return Le}});var F=t(97857),m=t.n(F),P=t(15009),h=t.n(P),N=t(99289),x=t.n(N),k=t(5574),d=t.n(k),D=t(70501),c=t(96364),g=t(92016),S=t(66309),G=t(53846),s=t(86074),V=function(Me){var p=Me.status,r=(0,s.jsx)(S.Z,{children:p||"-"});return[c.Bj[1].value].includes(p)?r=(0,s.jsx)(S.Z,{className:G.Z.invalidTag,style:{marginLeft:6},children:(0,s.jsx)(g.FormattedMessage,{id:"common.tag.text.noExist"})}):r=(0,s.jsx)(S.Z,{className:G.Z.validTag,style:{marginLeft:6},children:(0,s.jsx)(g.FormattedMessage,{id:"common.tag.text.exist"})}),r},ee=t(31732),te=t(24163),b=t(28235),w=t(72028),oe=t(37476),se=t(64317),ue=t(90672),$=t(68872),A=t(23323),R=t(96486),f=t(62435),a=function(p){var r=$.ZP.useMessage(),B=d()(r,2),ne=B[0],Ie=B[1],y=A.Z.useForm(),De=d()(y,1),pe=De[0],H=(0,g.useIntl)(),U=p.ignoreRiskFormVisible,C=p.riskInfo,ae=p.setIgnoreRiskFormVisible,Y=p.tableActionRef,Re=function(){pe.resetFields()},je=function(){ae(!1),Re()},_e=function(){var J=x()(h()().mark(function Oe(j){var I,ye,Ce;return h()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return I=m()(m()({},j),{},{riskId:C.id}),i.next=3,(0,w.ignoreRisk)(I);case 3:ye=i.sent,ye.code===200&&ye.msg==="success"&&(ne.success(H.formatMessage({id:"risk.message.api.ignore.risk.success"})),Y==null||(Ce=Y.current)===null||Ce===void 0||Ce.reload(),je());case 5:case"end":return i.stop()}},Oe)}));return function(j){return J.apply(this,arguments)}}();return(0,f.useEffect)(function(){U&&!(0,R.isEmpty)(C)&&pe.setFieldsValue({ignoreReasonType:C==null?void 0:C.ignoreReasonType,ignoreReason:C==null?void 0:C.ignoreReason})},[U,C]),(0,s.jsxs)(s.Fragment,{children:[Ie,(0,s.jsxs)(oe.Y,{labelCol:{span:H.locale==="en-US"?6:4},title:H.formatMessage({id:"risk.module.text.ignore.risk"}),width:520,form:pe,modalProps:{destroyOnClose:!0,onCancel:function(){return je()},styles:{body:{paddingTop:12}}},open:U,onFinish:_e,layout:"horizontal",children:[(0,s.jsx)(se.Z,{label:H.formatMessage({id:"risk.module.text.ignore.type"}),name:"ignoreReasonType",rules:[{required:!0}],options:c.$G}),(0,s.jsx)(ue.Z,{label:H.formatMessage({id:"risk.module.text.ignore.reason"}),name:"ignoreReason",rules:[{required:!0}],fieldProps:{rows:6}})]})]})},W=a,Se=t(92086),He=t(77603),Q=t(92635),de=t(79930),Z=t(17910),M=t(29448),ce=t(68795),me=t(39380),ge=t(93410),ve=t(70989),T=t(75302),be=t(3303),fe=t(86250),ke=t(34041),we=t(57381),z=t(83622),re=t(96074),L=t(86738),Ze=t(71230),he=t(15746),Ae=t(84567),Te=t(47908),Be=T.ZP.useBreakpoint,xe=be.Z.SHOW_CHILD,Fe=function(){var p,r=Be(),B=(0,g.useModel)("rule"),ne=B.platformList,Ie=B.ruleGroupList,y=B.ruleTypeList,De=B.allRuleList,pe=(0,g.useLocation)(),H=pe.search,U=new URLSearchParams(H),C=U.get("riskLevel"),ae=U.get("platform"),Y=U.get("ruleCode"),Re=U.get("resourceId"),je=$.ZP.useMessage(),_e=d()(je,2),J=_e[0],Oe=_e[1],j=(0,f.useRef)(),I=(0,f.useRef)(),ye=A.Z.useForm(),Ce=d()(ye,1),v=Ce[0],i=(0,g.useIntl)(),Lt=(0,f.useState)(!1),Ye=d()(Lt,2),jt=Ye[0],Je=Ye[1],Xe=(0,f.useRef)({}),_t=(0,f.useState)(!1),qe=d()(_t,2),Ot=qe[0],et=qe[1],tt=(0,f.useRef)({}),st=(0,f.useRef)({}),Pt=(0,f.useState)(!1),rt=d()(Pt,2),St=rt[0],nt=rt[1],bt=(0,f.useState)({}),at=d()(bt,2),it=at[0],Ne=at[1],kt=(0,f.useState)((p=c.MW[0])===null||p===void 0?void 0:p.value),lt=d()(kt,2),ie=lt[0],wt=lt[1],Zt=(0,f.useState)(!1),ot=d()(Zt,2),Bt=ot[0],ut=ot[1],Ft=function(){var l=x()(h()().mark(function n(e){var o,u,E;return h()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return o={riskId:e.id},K.next=3,(0,w.cancelIgnoreRisk)(o);case 3:u=K.sent,u.code===200&&u.msg==="success"&&(J.success(i.formatMessage({id:"risk.message.api.cancel.ignore.risk.success"})),j==null||(E=j.current)===null||E===void 0||E.reload());case 5:case"end":return K.stop()}},n)}));return function(e){return l.apply(this,arguments)}}(),Nt=(0,f.useState)([]),dt=d()(Nt,2),Vt=dt[0],Ve=dt[1],Wt=(0,g.useRequest)(function(l){return(0,de.queryGroupTypeList)({platformList:l})},{manual:!0,formatResult:function(n){var e=n.content;Ve(e||[])}}),ct=Wt.run;(0,f.useEffect)(function(){if((0,R.isEmpty)(ae)||(v==null||v.setFieldValue("platformList",[ae]),v.setFieldValue("resourceType",null),Ve([]),ct([ae])),(0,R.isEmpty)(C)||v==null||v.setFieldValue("riskLevelList",[C]),!(0,R.isEmpty)(Y)){var l;(l=I.current)===null||l===void 0||l.setFieldValue("ruleCodeList",[Y])}if(!(0,R.isEmpty)(Re)){var n;(n=I.current)===null||n===void 0||n.setFieldValue("resourceId",Re)}},[ae,C,Y,Re]);var We=(0,g.useRequest)(function(l){return(0,Q.cloudAccountBaseInfoList)(m()({},l))},{formatResult:function(n){if(n.msg==="success"){var e;return(n==null||(e=n.content)===null||e===void 0||(e=e.accountAliasList)===null||e===void 0?void 0:e.map(function(o){return{label:o,value:o}}))||[]}}}),Ut=We.data,mt=We.run,Kt=We.loading,Gt=(0,f.useMemo)(function(){var l=function(e){mt({platformList:v.getFieldValue("platformList")||[],cloudAccountSearch:e})};return(0,R.debounce)(l,500)},[Q.cloudAccountBaseInfoList]),gt=(0,g.useRequest)(function(l){return(0,w.listRuleStatistics)(m()({},l))},{manual:!0,formatResult:function(n){var e,o=[];return o=n==null||(e=n.content)===null||e===void 0?void 0:e.map(function(u){return{label:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)("span",{children:u==null?void 0:u.ruleName}),(0,s.jsx)(fe.Z,{align:"center",children:(0,s.jsx)(S.Z,{color:(0,M.nn)(Z.I9,u==null?void 0:u.riskLevel),style:{margin:"0 0 0 8px"},children:(u==null?void 0:u.count)||"-"})})]}),value:u.ruleId}}),o}}),$t=gt.data,Qt=gt.run,zt=function(){var l=x()(h()().mark(function n(){var e,o;return h()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:o=m()(m()({status:ie},v==null?void 0:v.getFieldsValue()),I==null||(e=I.current)===null||e===void 0?void 0:e.getFieldsValue()),ut(!0),(0,w.exportRiskList)(m()({},o),{responseType:"blob"}).then(function(_){(0,M.Uc)(_,"CloudRec ".concat(i.formatMessage({id:"risk.module.text.risk.data"}))),J.success(i.formatMessage({id:"common.message.text.export.success"}))}).finally(function(){return ut(!1)});case 3:case"end":return E.stop()}},n)}));return function(){return l.apply(this,arguments)}}(),Ht=(0,f.useState)(),vt=d()(Ht,2),Yt=vt[0],Jt=vt[1],Xt=function(){var l=x()(h()().mark(function n(e){var o,u;return h()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!e){_.next=4;break}return u=m()(m()({status:ie},v==null?void 0:v.getFieldsValue()),I==null||(o=I.current)===null||o===void 0?void 0:o.getFieldsValue()),_.next=4,Qt(u);case 4:case"end":return _.stop()}},n)}));return function(e){return l.apply(this,arguments)}}(),qt=function(){return{filterDropdown:function(e){var o=e.confirm;return(0,s.jsx)("div",{style:{padding:8},onKeyDown:function(E){return E.stopPropagation()},children:(0,s.jsx)(ke.Z,{maxTagCount:"responsive",allowClear:!0,mode:"multiple",placeholder:i.formatMessage({id:"common.select.text.placeholder"}),popupMatchSelectWidth:!1,options:$t||[],onChange:(0,R.debounce)(function(u){Jt(u),o()},1e3),style:{minWidth:180}})})},filterDropdownProps:{onOpenChange:Xt},filterIcon:function(e){return(0,s.jsx)(ce.Z,{style:{color:e?"#1677ff":void 0}})},destroyOnClose:!0}},es=function(n){nt(!0),st.current=n},ts=[m()({title:i.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleName",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){var o;return(0,s.jsxs)(fe.Z,{align:"center",children:[(0,s.jsx)("img",{src:(e==null?void 0:e.icon)||D.Z,alt:"RESOURCE_ICON",style:{width:18,height:18}}),(0,s.jsx)(te.Z,{text:(e==null||(o=e.ruleVO)===null||o===void 0?void 0:o.ruleName)||"-",maxWidth:r!=null&&r.xxl?280:240,rows:1,style:{color:"#333",fontSize:14,marginLeft:8},placement:"topLeft"})]})}},qt()),{title:i.formatMessage({id:"home.module.inform.columns.ruleName"}),dataIndex:"ruleCodeList",valueType:"select",valueEnum:(0,M.W_)(De),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:i.formatMessage({id:"risk.module.text.firstAndLast.discovered"}),dataIndex:"gmtCreated",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,s.jsxs)("div",{children:[(0,s.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtCreate)||"-"}),(0,s.jsx)("section",{style:{color:"#999"},children:(e==null?void 0:e.gmtModified)||"-"})]})}},{title:i.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonTypeList",valueType:"checkbox",valueEnum:(0,M.W_)(c.$G),align:"left",hideInTable:!0,hideInSearch:ie!=="IGNORED"},{title:i.formatMessage({id:"layout.routes.title.ruleGroup"}),dataIndex:"ruleGroupIdList",valueType:"select",valueEnum:(0,M.W_)(Ie),hideInTable:!0,fieldProps:{mode:"multiple"}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceTypeList",valueType:"cascader",align:"left",hideInTable:!0,fieldProps:{multiple:!0,showCheckedStrategy:xe,options:Vt,showSearch:!0,allowClear:!0}},{title:i.formatMessage({id:"home.module.inform.columns.ruleTypeName"}),dataIndex:"ruleTypeIdList",valueType:"cascader",hideInTable:!0,fieldProps:{multiple:!0,options:y,showCheckedStrategy:xe,fieldNames:{label:"typeName",value:"id",children:"childList"}}},{title:i.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"select",fieldProps:{placeholder:i.formatMessage({id:"common.select.query.text.placeholder"}),showSearch:!0,notFoundContent:Kt&&(0,s.jsx)(we.Z,{size:"small"}),onSearch:Gt,options:Ut||[]},align:"left",render:function(n,e){return(0,s.jsxs)("div",{children:[(0,s.jsx)("section",{style:{color:"rgb(51, 51, 51)"},children:(e==null?void 0:e.cloudAccountId)||"-"}),(0,s.jsxs)(fe.Z,{style:{fontSize:"12px",color:"#999"},children:[(0,M.c5)(e.platform,ne),(e==null?void 0:e.alias)||"-"]})]})}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,s.jsx)(ee.Z,{text:e==null?void 0:e.resourceType})}},{title:i.formatMessage({id:"cloudAccount.extend.title.asset.name"}),dataIndex:"resourceName",valueType:"text",align:"left",width:200,render:function(n,e){return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(b.Z,{placement:"topLeft",maxWidth:400,rows:1,text:(0,s.jsxs)(s.Fragment,{children:[e.resourceName||"-",(0,s.jsx)(V,{status:e==null?void 0:e.resourceStatus})]}),tooltipText:(e==null?void 0:e.resourceStatus)===c.Bj[1].value?"(".concat(i.formatMessage({id:"risk.module.text.not.exist"}),") ")+e.resourceName:e.resourceName||"-"})})}},{title:i.formatMessage({id:"common.table.columns.assetId"}),dataIndex:"resourceId",valueType:"text",align:"left",hideInTable:!0},{title:i.formatMessage({id:"common.table.columns.assetStatus"}),dataIndex:"resourceStatus",valueType:"select",valueEnum:(0,M.W_)(c.Bj),align:"left",hideInTable:!0},{title:i.formatMessage({id:"risk.module.text.first.discovery"}),dataIndex:"createTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:Z.El},search:{transform:function(n){return{gmtCreateStart:n[0],gmtCreateEnd:n[1]}}}},{title:i.formatMessage({id:"risk.module.text.recently.discovery"}),dataIndex:"modifiedTimeRange",valueType:"dateTimeRange",hideInTable:!0,fieldProps:{presets:Z.El},search:{transform:function(n){return{gmtModifiedStart:n[0],gmtModifiedEnd:n[1]}}}},{title:i.formatMessage({id:"home.module.inform.columns.riskLevel"}),dataIndex:"riskLevel",valueType:"text",align:"center",hideInSearch:!0,render:function(n,e){var o;return(0,M.Dd)(Z.I9,e==null||(o=e.ruleVO)===null||o===void 0?void 0:o.riskLevel)}},{title:i.formatMessage({id:"risk.module.text.risk.status"}),dataIndex:"status",valueType:"text",align:"left",hideInSearch:!0,render:function(n,e){return(0,M.Ff)(c.MW,e==null?void 0:e.status)}},{title:i.formatMessage({id:"risk.module.text.ignore.reason"}),dataIndex:"ignoreReason",valueType:"text",align:"left",hideInSearch:!0,hideInTable:ie!=="IGNORED",render:function(n,e){return(0,s.jsx)(te.Z,{placement:"topLeft",text:e.ignoreReason||"-",maxWidth:210})}},{title:i.formatMessage({id:"risk.module.text.ignore.type"}),dataIndex:"ignoreReasonType",valueType:"select",valueEnum:(0,M.W_)(c.$G),align:"left",hideInSearch:!0,hideInTable:ie!=="IGNORED"},{title:i.formatMessage({id:"cloudAccount.extend.title.cloud.operate"}),dataIndex:"option",valueType:"option",align:"center",fixed:"right",render:function(n,e){var o;return(0,s.jsxs)(s.Fragment,{children:[!((o=["WHITED"])!==null&&o!==void 0&&o.includes(e.status))&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.ZP,{size:"small",type:"link",onClick:function(){return es({riskId:e==null?void 0:e.id})},children:i.formatMessage({id:"common.button.text.white"})}),(0,s.jsx)(re.Z,{type:"vertical"})]}),e.status==="IGNORED"?(0,s.jsx)(L.Z,{title:(0,s.jsx)(s.Fragment,{}),description:i.formatMessage({id:"risk.module.text.cancel.ignore"}),onConfirm:function(){return Ft(e)},onCancel:function(){},okText:i.formatMessage({id:"common.button.text.ok"}),cancelText:i.formatMessage({id:"common.button.text.cancel"}),children:(0,s.jsx)(z.ZP,{size:"small",type:"link",children:i.formatMessage({id:"common.button.text.cancelIgnore"})})}):(0,s.jsx)(z.ZP,{size:"small",type:"link",onClick:function(){tt.current=m()({},e),et(!0)},children:i.formatMessage({id:"common.button.text.ignore"})}),(0,s.jsx)(re.Z,{type:"vertical"}),(0,s.jsx)(z.ZP,{size:"small",type:"link",target:"_self",onClick:function(){Je(!0),Xe.current=m()({},e)},children:i.formatMessage({id:"common.button.text.detail"})})]})}}],ss=function(){var l=x()(h()().mark(function n(e){var o,u,E,_,K,ft,ht,xt,Mt,Ue,It,Dt,pt,Pe,Rt,yt,Ct,Et,At,Ke,Ge,$e,Qe,X,ze,q,Tt;return h()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return E=e.pageSize,_=e.current,K=e.ruleId,ft=e.ruleGroupIdList,ht=e.cloudAccountId,xt=e.resourceName,Mt=e.resourceTypeList,Ue=e.status,It=Ue===void 0?"UNREPAIRED":Ue,Dt=e.ignoreReasonTypeList,pt=e.ruleTypeIdList,Pe=e.ruleIdList,Rt=e.gmtCreateStart,yt=e.gmtCreateEnd,Ct=e.gmtModifiedStart,Et=e.gmtModifiedEnd,At=e.resourceStatus,Ke=v.getFieldValue("platformList"),Ge=v.getFieldValue("riskLevelList"),$e=(o=I.current)===null||o===void 0?void 0:o.getFieldValue("ruleCodeList"),Qe=(u=I.current)===null||u===void 0?void 0:u.getFieldValue("resourceId"),X={page:_,size:E,ruleId:K,ruleGroupIdList:ft,cloudAccountId:ht,resourceName:xt,resourceTypeList:Mt,status:It,ignoreReasonTypeList:Dt,ruleTypeIdList:pt,gmtCreateStart:Rt,gmtCreateEnd:yt,gmtModifiedStart:Ct,gmtModifiedEnd:Et,resourceStatus:At},Ke&&(X.platformList=Ke),Ge&&(X.riskLevelList=Ge),$e&&(X.ruleCodeList=$e),Qe&&(X.resourceId=Qe),Pe&&!(0,R.isEmpty)(Pe)&&(X.ruleIdList=Pe),le.next=13,(0,w.queryRiskList)(X);case 13:return ze=le.sent,q=ze.content,Tt=ze.code,le.abrupt("return",{data:(q==null?void 0:q.data)||[],total:(q==null?void 0:q.total)||0,success:Tt===200||!1});case 17:case"end":return le.stop()}},n)}));return function(e){return l.apply(this,arguments)}}();return(0,s.jsxs)(me._z,{title:!1,className:Te.Z.riskPageContainer,breadcrumbRender:!1,children:[Oe,(0,s.jsx)(ge.Z,{bodyStyle:{paddingBlock:0},className:Te.Z.customFilterCard,tabs:{activeKey:ie,items:c.MW.map(function(l){return{label:l.label,key:l.value,children:(0,s.jsx)(A.Z,{form:v,children:(0,s.jsxs)(Ze.Z,{gutter:[24,10],children:[(0,s.jsx)(he.Z,{span:24,children:(0,s.jsx)(A.Z.Item,{name:"platformList",label:i.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,s.jsx)(Ae.Z.Group,{options:(0,M.T$)(ne),onChange:function(e){v.setFieldValue("resourceTypeList",null),Ve([]),ct(e),mt({platformList:e||[]})}})})}),(0,s.jsx)(he.Z,{span:24,children:(0,s.jsx)(A.Z.Item,{name:"riskLevelList",label:i.formatMessage({id:"home.module.inform.columns.riskLevel"}),style:{marginBottom:0},children:(0,s.jsx)(Ae.Z.Group,{options:(0,M.at)(Z.I9)})})})]})})}})||[],onChange:function(n){var e,o,u;wt(n),(e=I.current)===null||e===void 0||e.setFieldValue("ignoreReasonTypeList",[]),(o=I.current)===null||o===void 0||o.resetFields(),v.setFieldValue("platformList",[]),v.setFieldValue("riskLevelList",null),(u=j.current)===null||u===void 0||u.reset(),Ne({status:n})}}}),(0,s.jsx)(ve.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,defaultCollapsed:!1,collapseRender:!1,labelWidth:0},headerTitle:(0,s.jsx)("div",{className:G.Z.customTitle,children:i.formatMessage({id:"risk.module.text.risk.inquiry"})}),toolBarRender:function(){return[(0,s.jsx)(z.ZP,{type:"primary",loading:Bt,onClick:zt,children:i.formatMessage({id:"common.button.text.export"})},"export")]},actionRef:j,formRef:I,columns:ts,request:ss,onReset:function(){v.resetFields(),Ne({})},onSubmit:function(){var n=v.getFieldsValue();Ne(m()(m()({},it),n))},params:m()(m()({},it),{},{ruleIdList:Yt}),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1}}),(0,s.jsx)(Se.Z,{locate:"risk",riskDrawerVisible:jt,setRiskDrawerVisible:Je,riskDrawerInfo:Xe.current,tableActionRef:j}),(0,s.jsx)(W,{ignoreRiskFormVisible:Ot,setIgnoreRiskFormVisible:et,riskInfo:tt.current,tableActionRef:j}),(0,s.jsx)(He.Z,{editDrawerVisible:St,setEditDrawerVisible:nt,whiteListDrawerInfo:st.current,tableActionRef:j})]})},Le=Fe},70501:function(Ee,O,t){var F=t(62435),m=Object.defineProperty,P=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,x=(D,c,g)=>c in D?m(D,c,{enumerable:!0,configurable:!0,writable:!0,value:g}):D[c]=g,k=(D,c)=>{for(var g in c||(c={}))h.call(c,g)&&x(D,g,c[g]);if(P)for(var g of P(c))N.call(c,g)&&x(D,g,c[g]);return D};const d=D=>React.createElement("svg",k({className:"DEFAULT_RESOURCE_ICON_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:256,height:256},D),React.createElement("path",{d:"M827.52 782.08a39.84 39.84 0 0 0 56.64 0l104.32-103.36a119.68 119.68 0 0 0 0-170.08L886.4 405.92a40 40 0 0 0-56.8 56.16l90.88 92h-322.4a40 40 0 0 0 0 80h322.24l-92.48 91.52a40 40 0 0 0-.32 56.48z",fill:"#1480ED"}),React.createElement("path",{d:"M864 80h-52V40a40 40 0 0 0-80 0v40H550.08V40a40 40 0 0 0-80 0v40h-180V40a40 40 0 1 0-80 0v40H160A160 160 0 0 0 0 240v624a160 160 0 0 0 160 160h704a160 160 0 0 0 160-160 40 40 0 0 0-80 0 80 80 0 0 1-80 80H160a80 80 0 0 1-80-80V240a80 80 0 0 1 80-80h50.08v40a40 40 0 0 0 80 0v-40h180v40a40 40 0 0 0 80 0v-40H732v40a40 40 0 0 0 80 0v-40h52a80 80 0 0 1 80 80v90.08a40 40 0 0 0 80 0V240A160 160 0 0 0 864 80z",fill:"#2A5699"}));O.Z="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiI+PHBhdGggZD0iTTgyNy41MiA3ODIuMDhhMzkuODQgMzkuODQgMCAwIDAgNTYuNjQgMGwxMDQuMzItMTAzLjM2YTExOS42OCAxMTkuNjggMCAwIDAgMC0xNzAuMDhMODg2LjQgNDA1LjkyYTQwIDQwIDAgMCAwLTU2LjggNTYuMTZsOTAuODggOTJoLTMyMi40YTQwIDQwIDAgMCAwIDAgODBoMzIyLjI0bC05Mi40OCA5MS41MmE0MCA0MCAwIDAgMC0uMzIgNTYuNDh6IiBmaWxsPSIjMTQ4MEVEIi8+PHBhdGggZD0iTTg2NCA4MGgtNTJWNDBhNDAgNDAgMCAwIDAtODAgMHY0MEg1NTAuMDhWNDBhNDAgNDAgMCAwIDAtODAgMHY0MGgtMTgwVjQwYTQwIDQwIDAgMSAwLTgwIDB2NDBIMTYwQTE2MCAxNjAgMCAwIDAgMCAyNDB2NjI0YTE2MCAxNjAgMCAwIDAgMTYwIDE2MGg3MDRhMTYwIDE2MCAwIDAgMCAxNjAtMTYwIDQwIDQwIDAgMCAwLTgwIDAgODAgODAgMCAwIDEtODAgODBIMTYwYTgwIDgwIDAgMCAxLTgwLTgwVjI0MGE4MCA4MCAwIDAgMSA4MC04MGg1MC4wOHY0MGE0MCA0MCAwIDAgMCA4MCAwdi00MGgxODB2NDBhNDAgNDAgMCAwIDAgODAgMHYtNDBINzMydjQwYTQwIDQwIDAgMCAwIDgwIDB2LTQwaDUyYTgwIDgwIDAgMCAxIDgwIDgwdjkwLjA4YTQwIDQwIDAgMCAwIDgwIDBWMjQwQTE2MCAxNjAgMCAwIDAgODY0IDgweiIgZmlsbD0iIzJBNTY5OSIvPjwvc3ZnPg=="}}]);
